name: Release

on: [ workflow_dispatch ]

defaults:
  run:
    shell: bash

jobs:
  build:
    strategy:
      fail-fast: true
      matrix:
        platform: [ ubuntu-latest, windows-latest ]
    runs-on: ${{ matrix.platform }}
    steps:
      - name: Install Go
        uses: actions/setup-go@v4
        with:
          go-version: 1.x
          check-latest: true
      - name: Install Go tip
        run: |
          set -x
          go install golang.org/dl/gotip@latest
          gotip download
      - name: Zip Go installation
        run: |
          set -x
          zip -r go.zip $HOME/sdk/gotip
      - name: Release
        uses: marvinpinto/action-automatic-releases@v1.2.1
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          automatic_release_tag: "${matrix.platform}"
          files: |
            go.zip